#|
This file is a part of aoc-2022
(c) 2022 Janne Pakarinen (gingeralesy@gmail.com)
Author: Janne Pakarinen <gingeralesy@gmail.com>
|#

(in-package #:aoc-2022)

(defun day13-parse-list (line)
  (let (root stack current integer)
    (flet ((push-integer ()
             (let ((string (format NIL "狺铗弼弪箦轭翦珏颟┅瘐箬疳蝮瀛轭翦珏篝蜷铉沲蝌孱舂箦翩轭翦珏紊泰┅瘐箬篝徙ī瘐箬沲蝌孱篝徙氅箦翩沲蝌孱紊泰痫瓠篝徙ī躅戾篌篝徙ㄥ蝌矧⑼轶箝铉йМ┅箦翩沲蝌孱铗弼弪箦沲蝌孱舂箦翩蝻雉沲蝌孱舂换澡灬篝镱鏖祆孱躔狍蝻雉戾è疳蝈铘痫篝徙氅┅瘐箬沲蝌孱疳蝈铘箦翩沲蝌孱疳蝈铘┅┅祜镳骘汨徙蝻篌扉铄滹ㄥ汜箦汨ǎ苒瘐箬篝徙氅ǎ茌麒孱轭翦珏瘐箬轭翦珏颟痫瓠篝徙氅ǎ墁麒孱轭翦珏瘐箬轭翦珏颟┅è＼＼＼＼＼＼＼＼＼＼供瘐箬汨轭翦珏颟┅┅ㄩ篝徙ㄥ蝌矧⑼轶箝铉лМ蝻雉┅ㄤ彐躅溽背疳蝮瀛扉篝ī鏖翳镳孱骈戾篝蝈犴ㄩ铕豸背洪姝滹弩铒舡屮轶哄蝌矧祜镳骘骈蝮ㄣ戾犷蝈徜扉铄篝蝈犴紊泰骘箦泔钿ㄣ戾犷蝈徜扉铄篝蝈犴紊泰骘翳轵ㄣ戾犷蝈徜扉铄篝蝈犴紊泰麒殪骈蝮躅戾篌箦泔钿滹ㄥ蝌矧⑼轶箝铉箦泔钿栳戽镦翳疳轵、躅戾篌矧铛祆翳轵洎戾铉翳翳轵洎┅滹ㄥ蝌矧⒃栝蜾扉铄麽铒屙痿、泔祆邈ㄣ镱ㄤ狴背疳蝮瀛扉篝骈蝮舂ㄤ狴背疳蝮瀛扉篝箦泔钿┅┅ㄤ彐躅溽背泔眇狎戾骠蜷玷舂ㄤ邈灬蝈豉疱扉篝戾骠蜷玷舂戾è鲠祯弩ㄣ镱戾骠蜷玷舂篝徙塍ㄣ镱紊紊泰┅ㄦ戾è戾骠īㄣ狎鲠祯弩┅蜷玷īㄣ潋鲠祯弩┅扉篝殒戾骠ī躅戾篌扉篝ㄣ狎鲠祯弩┅箦翩ㄣ狎鲠祯弩扉篝ㄣ狎鲠祯弩┅┅扉篝殒蜷玷ī躅戾篌扉篝ㄣ潋鲠祯弩┅箦翩ㄣ潋鲠祯弩扉篝ㄣ潋鲠祯弩┅┅瘐箬戾骠ī瘐箬ㄣ狎鲠祯弩ㄣ狎篝徙塍┅箦翩ㄣ狎鲠祯弩ㄣ後鲠祯弩┅瘐箬蜷玷ī瘐箬ㄣ潋鲠祯弩ㄣ潋篝徙塍┅箦翩ㄣ潋鲠祯弩ㄣ徜鲠祯弩┅痫瓠戾骠ī祜镳滹箦翩ㄣ狎鲠祯弩ㄣ潋痫ㄣ狎篝徙塍┅┅麒殪ㄡ钿铛祆ㄣ狎鲠祯弩┅ㄣ狎篝徙塍┅┅痫瓠蜷玷ī祜镳滹箦翩ㄣ潋鲠祯弩ㄣ潋痫ㄣ潋篝徙塍┅┅麒殪ㄡ钿铛祆ㄣ潋鲠祯弩┅ㄣ潋篝徙塍┅┅祜镳滹ㄣ镱è铛祆戾骠┅痫瓠戾骠躅戾篌戾骠蝈趱蝾骝镯溽背泔眇狎冤┅è铛祆蜷玷舂痫瓠蜷玷舂躅戾篌蜷玷舂蝈趱蝾骝镯溽背泔眇狎紊泰┅è犷ㄩ铘彗弪戾骠┅ㄩ铘彗弪蜷玷舂┅麒孱ǒ戾骠蜷玷舂蝈趱蝾骝镯溽背泔眇狎戾骠蜷玷舂┅痫瓠戾骠痫瓠蜷玷舂è轭翦珏蝠戾骠┅扉篝殒戾骠┅è轭翦珏蝠蜷玷舂扉篝殒蜷玷舂è犷扉篝戾骠扉篝蜷玷舂瘐箬戾骠瘐箬蜷玷舂┅┅┅ㄤ彐躅溽背瘐戾ī祜镳骘戾骠蜷玷舂轭ㄤ狴背疳蝮瀛扉篝螬骘骝镯骘蝈篚祠ㄤ狴背泔眇狎戾骠蜷玷舂麒孱蝈篚祠篚轭麸篚麒孱蝈篚祠泔祆邈轭麸泔蝌邈骈钺祆蝈趱蝾鲠祯弩篚泔蝌邈舂┅